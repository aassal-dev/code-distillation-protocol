# Strategy Evaluation: The Codebase Distillation Protocol

**Version:** 0.0.4 **Status:** Beta - In-Editor "Composer" Workflow.

## 1. Executive Summary

The protocol focuses on **Active Extraction** of engineering wisdom from high-quality open-source repositories. The goal is to distill "DNA" (patterns, tricks, decisions) into a **Universal Global Library** of atomic assets.

**New in v0.0.4:** We have replaced the external shell script with an **In-Editor Composer Protocol**. You can now run the entire workflow without leaving Cursor AI.

## 2. Ecosystem Context & "The Gap"

You asked about `skill.md`, `.mdc`, and `workflow.md`. Here is how this protocol fits:

|   |   |   |
|---|---|---|
|**Format**|**Purpose**|**How We Leverage It**|
|**`.cursorrules`**|Global instructions for the Cursor AI editor.|**Output Target:** We generate snippets _for_ this file.|
|**`.mdc` (Claude)**|"Model Document Context" - tells Claude _when_ to read specific docs.|**Deployment Strategy:** We should save our Atomic Patterns as `.mdc` files. Example: `pattern-retry.mdc` triggers only when Claude sees networking code.|
|**`skill.md`**|Defines _tools_ an agent can run (executables).|**Distinct:** Our library provides _wisdom_, not executable tools. We are building the "Brain", not the "Hands".|

## 3. The "Fractal Extraction" Methodology

To ensure we don't miss "Code-Level Optimizations," we define four layers of extraction:

1. **System Level:** Architecture, caching strategies, database choices.
    
2. **Module Level:** Design patterns (Factory, Observer), folder structure.
    
3. **Class/Function Level:** API design, error handling wrappers.
    
4. **Line Level (The "Metal"):** Bitwise hacks, loop unrolling, memory pointer tricks, specific regex optimizations.
    

## 4. The Orchestration Architecture (v0.0.4 Update)

We have moved the orchestration **inside Cursor**:

- **The Driver:** You paste `distillation_workflow.md` into Composer.
    
- **Step 1 (Auto-Survey):** Composer reads the file tree and generates the JSON plan in-memory.
    
- **Step 2 (Sequential Extraction):** Composer iterates through the JSON plan, creating files one by one (or in batches) directly in your file explorer.
    
- **Step 3 (The Librarian):** A final prompt merges the results.
    

## 5. Scoring (v0.0.4)

|   |   |   |
|---|---|---|
|**Metric**|**Score**|**Notes**|
|**Automation**|9/10|No context switching. The IDE _is_ the runner.|
|**Granularity**|9.5/10|"Fractal Extraction" ensures we catch both architecture and bit-twiddling hacks.|
|**UX**|10/10|**Huge Improvement.** You simply type "Run Protocol" in the chat.|