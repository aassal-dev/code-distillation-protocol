# The Codebase Distillation Prompts

**Version:** 0.0.4

**Focus:** Unbounded Discovery & Fractal Extraction.

These prompts are designed to be inputs for the specific agents defined in `distillation_workflow.md`.

## Prompt 1: The Surveyor (Phase 1)

**Context:** Root of the repository.

**Output Target:** `extraction_targets.json`

> **Prompt:**
> 
> "Act as a Senior Software Architect. Scan this repository to create a comprehensive Work Breakdown Structure for deep analysis.
> 
> **Objective:** Identify **ALL** modules, directories, or core files that contain significant engineering complexity.
> 
> **Scope:**
> 
> - **INCLUDE:** Core logic, custom algorithms, state management, performance layers, utilities, and 'metal' optimizations.
>     
> - **EXCLUDE:** Standard CRUD boilerplate, UI components (unless complex), assets, auto-generated code, and config files.
>     
> - **NO LIMITS:** Do not limit yourself to a specific number of targets. If there are 50 complex files, list all 50.
>     
> 
> **Analysis Strategy:**
> 
> 1. Look at file sizes and names. (High complexity often hides in `utils`, `core`, `lib`, or `engine` folders).
>     
> 2. Look for files with 'hack', 'optimize', 'buffer', or 'cache' in the comments or names.
>     
> 
> **Output Requirement:**
> 
> DO NOT output a report.
> 
> Output ONLY a valid JSON object strictly following this structure (save as `extraction_targets.json`):
> 
> ```
> [
>   {
>     "target_id": "unique_id",
>     "path": "path/to/folder_or_file",
>     "focus": "What specific aspect to look for (e.g., Memory Management, API Design)",
>     "abstraction_level": "Select one: [System, Module, Class, Line-Level]"
>   }
> ]
> ```
> 
> Ensure you select a mix of abstraction levels. I want at least one target focused on 'Line-Level' optimizations (e.g., utils, math, parsers)."

## Prompt 2: The Atomizer (Phase 2)

**Context:** The specific `path` defined in the target JSON.

**Input:** `focus` and `abstraction_level` from the target JSON.

> **Prompt:**
> 
> "You are an Extraction Agent. Your target is `{path}`.
> 
> Your mission: Extract **Atomic Patterns** and **Tricks** focusing on `{focus}` at the `{abstraction_level}` level.
> 
> **The Fractal Levels (What to look for):**
> 
> - **If System:** Look for queue architecture, caching layers, microservice communication.
>     
> - **If Module:** Look for clean architecture, dependency injection, factory patterns.
>     
> - **If Class:** Look for smart API surfaces, ergonomic method signatures.
>     
> - **If Line-Level:** Look for bitwise operations, custom memory allocators, loop unrolling, regex hacks, or masterful use of language features (e.g., Python decorators, Rust lifetimes).
>     
> 
> **Output Requirement:**
> 
> For EACH finding, generate a separate Markdown file named `finding_{id}_{short_name}.md`.
> 
> Use the Standard Artifact Template.
> 
> **Critical:** If you find a 'Line-Level' trick, you MUST explain exactly _how_ it works and _why_ it is faster/safer than the standard approach."

## Prompt 3: The Librarian (Phase 3)

**Context:** The folder of raw findings.

> **Prompt:**
> 
> "You are the Keeper of the Global Library.
> 
> 1. Read all `finding_*.md` files provided.
>     
> 2. Merge any duplicates.
>     
> 3. **Quality Check:** Discard any findings that are 'Common Knowledge' (e.g., 'Using .map() is good'). Keep only the 'Cunning', 'Novel', or 'Masterful'.
>     
> 4. **Final Polish:** Format the remaining findings into the final `pattern_[name].md` format with YAML frontmatter.
>     
> 5. **Tagging:** Assign semantic tags for future retrieval."
>