# The Codebase Distillation Protocol (In-Editor Driver)

**Version:** 0.2.03

**Type:** Agent Protocol / Meta-Prompt

**Execution Environment:** Cursor Composer (Cmd+I) or Claude Code

**Prerequisite:** Open the target repository in Cursor. If you have theoretical documents or specific goals, open them in the editor as well.

## ðŸš€ How to Run This

1. **Open Cursor Composer (Cmd+I).**
    
2. **Copy & Paste** the text below into the chat.
    
3. **Hit Enter.**
    

## ðŸ¤– The Protocol Instructions

I want you to act as a **Reverse Engineering Agent** to distill this codebase. Follow these 4 phases sequentially. Pause after Phase 1 and Phase 2 for my confirmation if needed, otherwise proceed.

### Phase 1: The Director (Goal Setting & Intent)

**Goal:** Determine _what_ we should be looking for before scanning code.

**Action:**

1. Read the `README.md`, user-facing documentation, and any theoretical context files I have provided.
    
2. Determine the primary value propositions and unique features of this repository.
    
3. **Create a file** named `_distillation/learning_objectives.md`.
    
4. In this file, list 3-5 specific "Learning Targets" (e.g., "Target 1: How do they handle real-time spatial zoom?", "Target 2: How is the Context Engine indexing documents?").
    

### Phase 2: The Surveyor (Map the Territory)

**Goal:** Map the learning targets to specific codebase locations.

**Action:**

1. Read the `_distillation/learning_objectives.md` file you just created.
    
2. Scan the file tree and codebase structure to find the "Nerve Centers" that actually implement those specific objectives.
    
3. **Create a file** named `_distillation/extraction_plan.json`.
    

**JSON Format for Output:**

```
[
  { "id": "01", "path": "src/core/agent_loop.py", "focus": "Target 1: Orchestration Logic", "depth": "System" },
  { "id": "02", "path": "src/utils/memory.py", "focus": "Target 2: Memory Optimization", "depth": "Line-Level" }
]
```

### Phase 3: The Atomizer (Execute the Extraction)

**Goal:** Extract Atomic Patterns.

**Action:**

Read `_distillation/extraction_plan.json`. Iterate through **every** target. For each target:

1. Read the source code at the `path`.
    
2. Analyze it for 'Cunning Tricks', 'Patterns', or 'Optimizations' that solve the stated `focus`.
    
3. **Generate a new Markdown file** in `_distillation/findings/` for each distinct pattern.
    
4. **Filename:** `finding_{id}_{pattern_name}.md`.
    

**Content Template (Strictly Follow This):**

Use the standard atomic pattern template (YAML tags, Insight, Trick, Code Snippet, AI Rule).

### Phase 4: The Librarian (Final Polish)

**Goal:** Consolidate and Clean.

**Action:**

1. Read all files in `_distillation/findings/`.
    
2. Merge duplicates.
    
3. Delete low-value findings (common knowledge).
    
4. **Move** valid files to `_distillation/library/`.
    
5. **Delete** the raw `_distillation/findings/` folder.